"use strict";var Deck=function(){function t(t){if("undefined"!=typeof I[t])return I[t];if("undefined"!=typeof O[t])return I[t]=t,t;for(var n,e=t[0].toUpperCase()+t.slice(1),r=["webkit","moz","Moz","ms","o"],o=0,u=r.length;u>o;o++)if(n=r[o]+e,"undefined"!=typeof O[n])return I[t]=n,n}function n(t,n,r){return"undefined"!=typeof v||(v=e()),r=r||0,v?"translate3d("+t+", "+n+", "+r+")":"translate("+t+", "+n+")"}function e(){var n=t("transform"),e=document.createElement("p");return document.body.appendChild(e),e.style[n]="translate3d(1px,1px,1px)",v=e.style[n],v=null!=v&&v.length&&"none"!==v,document.body.removeChild(e),v}function r(t,n){var e=Date.now(),r=e+t,u=r+n,i={start:r,end:u};C.push(i),m||(m=!0,requestAnimationFrame(o));var c={start:function(t){return i.startcb=t,c},progress:function(t){return i.progresscb=t,c},end:function(t){return i.endcb=t,c}};return c}function o(){var t=Date.now();if(1e3/60>t-E)return void requestAnimationFrame(o);if(E=t,!C.length)return void(m=!1);for(var n,e=0;e<C.length;e++)if(n=C[e],!(t<n.start)){n.started||(n.started=!0,n.startcb&&n.startcb());var r=(t-n.start)/(n.end-n.start);n.progresscb&&n.progresscb(1>r?r:1),t>n.end&&(n.endcb&&n.endcb(),C.splice(e--,1))}requestAnimationFrame(o)}function u(t){var n=Math.round(Math.random())?-1:1;return n*t}function i(t){for(var n,e,r=t.length-1;r;r--)n=Math.random()*r|0,e=t[r],t[r]=t[n],t[n]=e;return t}function c(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function a(t){return t*Math.PI/180}function f(t){return document.createElement(t)}function s(e){function r(t){t.card&&t.card(w)}function o(t){function e(t){k&&("mousemove"===t.type?(u.x=t.clientX,u.y=t.clientY):(u.x=t.touches[0].clientX,u.y=t.touches[0].clientY),m.style[s]=n(Math.round(w.x+u.x-o.x)+"px",Math.round(w.y+u.y-o.y)+"px")+(w.rot?" rotate("+w.rot+"deg)":""))}function r(t){q&&Date.now()-i<200&&w.setSide("front"===w.side?"back":"front"),"mouseup"===t.type?(p(window,"mousemove",e),p(window,"mouseup",r)):(p(window,"touchmove",e),p(window,"touchend",r)),k&&(w.x=w.x+u.x-o.x,w.y=w.y+u.y-o.y)}var o={},u={},i=Date.now();t.preventDefault(),"mousedown"===t.type?(o.x=u.x=t.clientX,o.y=u.y=t.clientY,l(window,"mousemove",e),l(window,"mouseup",r)):(o.x=u.x=t.touches[0].clientX,o.y=u.y=t.touches[0].clientY,l(window,"touchmove",e),l(window,"touchend",r)),k&&(m.style[s]=n(w.x+"px",w.y+"px")+(w.rot?" rotate("+w.rot+"deg)":""),m.style.zIndex=L++)}function u(t){t.appendChild(m),w.$root=t}function i(){w.$root&&w.$root.removeChild(m),w.$root=null}function c(t){"front"===t?("back"===w.side&&m.removeChild(b),w.side="front",m.appendChild(g),w.setRankSuit(w.rank,w.suit)):("front"===w.side&&m.removeChild(g),w.side="back",m.appendChild(b),m.setAttribute("class","card"))}var a,s=t("transform"),y=e%13+1,x=e/13|0,v=(52-e)/4,m=f("div"),g=f("div"),b=f("div"),k=!1,q=!1,w={i:e,rank:y,suit:x,pos:e,$el:m,mount:u,unmount:i,setSide:c},O=h.modules;g.classList.add("face"),b.classList.add("back"),m.style[s]=n(-v+"px",-v+"px"),w.x=-v,w.y=-v,w.z=v,w.rot=0,w.setSide("back"),l(m,"mousedown",o),l(m,"touchstart",o);for(a in O)r(O[a]);return w.setRankSuit=function(t,n){var e=d(n);m.setAttribute("class","card "+e+" rank"+t)},w.setRankSuit(y,x),w.enableDragging=function(){k||(k=!0,m.style.cursor="move")},w.enableFlipping=function(){q||(q=!0)},w.disableFlipping=function(){q&&(q=!1)},w.disableDragging=function(){k&&(k=!1,m.style.cursor="")},w}function d(t){return 0===t?"spades":1===t?"hearts":2===t?"clubs":3===t?"diamonds":"joker"}function l(t,n,e){t.addEventListener(n,e)}function p(t,n,e){t.removeEventListener(n,e)}function y(t){function n(t){return function(){var n=this,r=arguments;e(function(e){t.apply(n,o.concat.apply(e,r))})}}function e(t){t&&(u.push(t),1===u.length&&r())}function r(){u[0](function(t){if(t)throw t;u=u.slice(1),u.length&&r()})}var o=Array.prototype,u=[];return t.queue=e,t.queued=n,t}function x(t){function n(t,n,e){u[t]||(u[t]=[]),u[t].push({cb:n,ctx:e})}function e(t,n,e){u[t]||(u[t]=[]),u[t].push({cb:n,ctx:e,once:!0})}function r(t){var n=this,e=Array.prototype.slice(arguments,1),r=u[t]||[];r.filter(function(t){return t.cb.apply(n,e),!t.once})}function o(t,n){return t?n?void(u[t]=u[t].filter(function(t){return t.cb!==n})):void(u[t]=[]):void(u={})}t||(t={});var u={};return t.on=n,t.one=e,t.off=o,t.trigger=r,t}function h(t){function n(t){o=t,o.appendChild(c)}function e(){o.removeChild(c)}function r(t){t.deck&&t.deck(a)}var o,u,i=new Array(t?55:52),c=f("div"),a=x({mount:n,unmount:e,cards:i,$el:c}),d=h.modules;y(a);for(u in d)r(d[u]);c.classList.add("deck");for(var l,p=i.length;p;p--)l=i[p-1]=s(p-1),l.mount(c);return a}var v,m,g,b,k,q,w={deck:function(t){function n(n){var e=t.cards.filter(function(t){return"front"===t.side}).length/t.cards.length;t.cards.forEach(function(t,n){t.setSide(e>.5?"back":"front")}),n()}t.flip=t.queued(n)}},O=document.createElement("p").style,I={},M={linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return.5>t?2*t*t:-1+(4-2*t)*t},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return 1+--t*t*t*t*t},quintInOut:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t}},C=[],E=0,$={deck:function(t){function n(n,e){var r=t.cards;r.sort(function(t,n){return e?t.i-n.i:n.i-t.i}),r.forEach(function(t,o){t.sort(o,r.length,function(t){t===r.length-1&&n()},e)})}t.sort=t.queued(n)},card:function(e){var o=t("transform"),u=e.$el;e.sort=function(t,i,c,a){var f,s,d,l,p,y,x=t/4,h=10*t;r(h,400).start(function(){f=e.x,s=e.y,d=e.rot,l=-x-f,p=-150-s,y=0-d}).progress(function(t){t=M.quadOut(t),e.x=f+l*t,e.y=s+p*t,e.rot=d+y*t,u.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}).end(function(){u.style.zIndex=t}),r(h+500,400).start(function(){s=e.y,p=-x-s}).progress(function(t){t=M.quadOut(t),e.y=s+p*t,u.style[o]=n(-x+"px",e.y+"px")}).end(function(){c(t)})}}},S={deck:function(t){function n(n){var e=t.cards;g=c(),i(e),e.forEach(function(t,r){t.pos=r,t.shuffle(function(t){t===e.length-1&&n()})})}t.shuffle=t.queued(n)},card:function(e){var o=t("transform"),i=e.$el;e.shuffle=function(t){var c,a,f,s,d,l,p=e.pos,y=p/4,x=u(40*Math.random()+20)*g/16,h=2*p;r(h,200).start(function(){c=e.x,a=e.y,f=e.rot||0,s=x-c,d=-y-a,l=0-f}).progress(function(t){t=M.quadOut(t),e.x=c+s*t,e.y=a+d*t,e.rot=f+l*t,i.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}),r(200+h,200).start(function(){c=e.x,a=e.y,f=e.rot||0,s=-y-c,d=-y-a,l=0-f,i.style.zIndex=p}).progress(function(t){t=M.quadOut(t),e.x=c+s*t,e.y=a+d*t,e.rot=f+l*t,i.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}).end(function(){setTimeout(function(){t(p)},0)})}}},z={deck:function(t){function n(n){var e=t.cards,r=e.length;b=c(),e.slice(-5).reverse().forEach(function(t,e){t.poker(e,r,function(e){t.setSide("front"),4===e&&n()})})}t.poker=t.queued(n)},card:function(e){var o=t("transform"),u=e.$el;e.poker=function(t,i,c){var a,f,s,d,l,p,y=250*t,x={x:Math.round(70*(t-2.05)*b/16),y:Math.round(-110*b/16)};r(y,250).start(function(){a=e.x,f=e.y,s=e.rot||0,d=x.x-a,l=x.y-f,p=0-s,u.style.zIndex=i-1+t}).progress(function(t){t=M.quadOut(t),e.x=a+d*t,e.y=f+l*t,e.rot=s+p*t,u.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}).end(function(){c(t)})}}},A={deck:function(t){function n(n){var e=t.cards;e.forEach(function(t,o){t.setSide("front"),t.intro(o,function(o){r(250,0).start(function(){t.setSide("back")}),o===e.length-1&&n()})})}t.intro=t.queued(n)},card:function(e){var o=t("transform"),u=e.$el;e.intro=function(t,i){var c=500+10*t,a=t/4;u.style[o]=n(-a+"px","-250px"),u.style.opacity=0,e.x=-a;var f=-a- -250;r(c,1e3).start(function(){u.style.zIndex=t}).progress(function(t){u.style.opacity=t,t=M.quartOut(t),e.y=-250+f*t,u.style[o]=n(-a+"px",e.y+"px")}).end(function(){u.style.opacity="",i&&i(t)})}}},D={deck:function(t){function n(n){var e=t.cards,r=e.length;k=c(),e.forEach(function(t,o){t.fan(o,r,function(t){t===e.length-1&&n()})})}t.fan=t.queued(n)},card:function(e){var o=t("transform"),u=e.$el;e.fan=function(t,i,c){var f,s,d,l,p,y,x=t/4,h=10*t,v=t/(i-1)*260-130;r(h,300).start(function(){f=e.x,s=e.y,d=e.rot||0,l=-x-f,p=-x-s,y=0-d}).progress(function(t){t=M.quadOut(t),e.x=f+l*t,e.y=s+p*t,e.rot=d+y*t,u.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}),r(300+h,300).start(function(){f=e.x,s=e.y,d=e.rot||0,l=55*Math.cos(a(v-90))*k/16-f,p=55*Math.sin(a(v-90))*k/16-s,y=v-d}).progress(function(t){t=M.quadOut(t),e.x=f+l*t,e.y=s+p*t,e.rot=d+y*t,u.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}).end(function(){c(t)})}}},F={deck:function(t){function n(n){var e=t.cards;q=c(),e.forEach(function(t){t.bysuit(function(t){t===e.length-1&&n()})})}t.bysuit=t.queued(n)},card:function(e){var o=t("transform"),u=e.rank,i=e.suit,c=e.$el;e.bysuit=function(t){var a,f,s,d,l,p,y=e.i,x=10*y,h=-Math.round(8*(6.75-u)*q/16),v=-Math.round(92*(1.5-i)*q/16);r(x,400).start(function(){a=e.x,f=e.y,l=e.rot||0,s=h-a,d=v-f,p=0-l}).progress(function(t){t=M.quadOut(t),e.x=a+s*t,e.y=f+d*t,e.rot=l+p*t,c.style[o]=n(e.x+"px",e.y+"px")+(e.rot?" rotate("+e.rot+"deg)":"")}).end(function(){t(y)})}}},L=52;return h.modules={bysuit:F,fan:D,intro:A,poker:z,shuffle:S,sort:$,flip:w},h.Card=s,h.prefix=t,h.translate=n,h}();